(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3097],{3787:function(e,a,t){Promise.resolve().then(t.bind(t,979))},2023:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(8030).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},9451:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,t(8030).Z)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]])},979:function(e,a,t){"use strict";t.r(a);var s=t(7437),l=t(2265),r=t(7632),i=t(4682),n=t(3260),o=t(1340),d=t(7138),c=t(6463),m=t(3274),g=t(8604),u=t(5137),x=t(9451),h=t(6780),p=t(9061),f=t(2468),b=t(6127),j=t(690),y=t(9338),v=t(883),N=t(8954),w=t(2023),k=t(9775);a.default=e=>{let{params:a}=e,{user:t}=(0,r.E)();(0,c.useRouter)();let[_,Z]=(0,l.useState)(null),[S,C]=(0,l.useState)(!0),[$,P]=(0,l.useState)(!1),[M,G]=(0,l.useState)(""),[T,E]=(0,l.useState)(""),[U,q]=(0,l.useState)({post_title:"",category:"",location:"",deskripsi:"",tanggal_unggahan:"",style_view:"1-Grid"}),[F,K]=(0,l.useState)(Array(30).fill(null)),[L,R]=(0,l.useState)(Array(15).fill(null)),[A,O]=(0,l.useState)([]),[D,H]=(0,l.useState)(-1),[z,J]=(0,l.useState)(!1),V=async()=>{try{C(!0);let e=await (0,k.sg)("/v1.0/admin/gallery/get",{slug:a.slug});if(!e.success)throw Error("string"==typeof e.data?e.data:"Failed to load gallery");let t=e.data;Z(t),q({post_title:t.post_title||"",category:t.category||"",location:t.location||"",deskripsi:t.deskripsi||"",tanggal_unggahan:t.tanggal_unggahan||"",style_view:t.style_view||"1-Grid"});let s=[];for(let e=1;e<=30;e++){let a=`image_url${e}`;s.push(t[a]||null)}K(s);let l=[];for(let e=1;e<=15;e++){let a=`video_url${e}`;l.push(t[a]||null)}if(R(l),t.thumbnail){let e=s.findIndex(e=>e===t.thumbnail);H(e)}O([]),J(!1)}catch(e){e instanceof k.MS?G(e.message):G(e instanceof Error?e.message:"Failed to load gallery")}finally{C(!1)}},W=()=>{if(!_)return!1;let e=U.post_title!==_.post_title||U.category!==_.category||U.location!==(_.location||"")||U.deskripsi!==(_.deskripsi||"")||U.tanggal_unggahan!==(_.tanggal_unggahan||"")||U.style_view!==_.style_view,a=A.length>0;return e||a};(0,l.useEffect)(()=>{t?.email&&(document.title=`${U.post_title} | ${t.email}`)},[t?.email,U.post_title]);let B=(e,a)=>{q(t=>({...t,[e]:a})),setTimeout(()=>{J(W())},0)},I=(e,a)=>{let t=new FileReader;t.onload=t=>{let s=t.target?.result;K(a=>{let t=[...a];return t[e]=s,t}),O(t=>[...t.filter(a=>!("image"===a.type&&a.index===e)),{action:"upload",index:e,type:"image",file:a,preview:s}]),J(!0)},t.readAsDataURL(a)},Q=(e,a)=>{let t=URL.createObjectURL(a);R(a=>{let s=[...a];return s[e]=t,s}),O(s=>[...s.filter(a=>!("video"===a.type&&a.index===e)),{action:"upload",index:e,type:"video",file:a,preview:t}]),J(!0)},X=(e,a)=>{"image"===a?(e===D&&H(-1),K(a=>{let t=[...a];return t[e]=null,t})):R(a=>{let t=[...a];return t[e]=null,t}),O(t=>{let s=t.filter(t=>!(t.type===a&&t.index===e)),l="image"===a?`image_url${e+1}`:`video_url${e+1}`;return _&&_[l]?[...s,{action:"delete",index:e,type:a}]:s}),J(!0)},Y=e=>{F[e]&&(H(e),J(!0))},ee=async()=>{try{if(P(!0),G(""),!U.post_title.trim()){G("Judul portofolio harus diisi");return}if(!U.category.trim()){G("Kategori harus diisi");return}if(-1===D||!F[D]){G("Thumbnail harus dipilih dari salah satu gambar");return}let e=new FormData;e.append("id",_.id.toString()),e.append("post_title",U.post_title.trim()),e.append("category",U.category.trim()),e.append("location",U.location),e.append("deskripsi",U.deskripsi),e.append("tanggal_unggahan",U.tanggal_unggahan),e.append("style_view",U.style_view),e.append("thumbnail_index",D.toString()),A.forEach(a=>{"delete"===a.action?e.append(`delete_${a.type}_${a.index+1}`,"true"):"upload"===a.action&&a.file&&("image"===a.type?e.append(`image_${a.index+1}`,a.file):e.append(`video_${a.index+1}`,a.file))});let a=await (0,k.U8)("/v1.0/admin/gallery/update",e);a.success?(E("Portofolio berhasil diupdate"),G(""),O([]),J(!1),await V()):G(a.data||"Gagal mengupdate portofolio")}catch(e){e instanceof k.MS?G(e.message):G(e instanceof Error?e.message:"Gagal menyimpan portofolio")}finally{P(!1)}};if((0,l.useEffect)(()=>{V()},[a.slug]),(0,l.useEffect)(()=>{if(T){let e=setTimeout(()=>E(""),3e3);return()=>clearTimeout(e)}},[T]),(0,l.useEffect)(()=>{if(M){let e=setTimeout(()=>G(""),5e3);return()=>clearTimeout(e)}},[M]),S)return(0,s.jsx)(i.Z,{requiredRole:"moderator",children:(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(m.Z,{className:"w-8 h-8 animate-spin text-purple-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Memuat data portofolio..."})]})})});if(!_)return(0,s.jsx)(i.Z,{requiredRole:"moderator",children:(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(g.Z,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Portofolio Tidak Ditemukan"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Portofolio yang Anda cari tidak ditemukan atau sudah dihapus."}),(0,s.jsxs)(d.default,{href:"/dashboard/kelola-portofolio",className:"inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:[(0,s.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Kembali ke Kelola Portofolio"]})]})})});let ea=U.post_title.trim()&&U.category.trim()&&-1!==D&&F[D];return(0,s.jsx)(i.Z,{requiredRole:"moderator",children:(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-4 lg:py-8",children:(0,s.jsxs)("div",{className:"max-w-5xl mx-auto px-4",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("div",{className:"flex items-center mb-4",children:(0,s.jsxs)(d.default,{href:"/dashboard/kelola-portofolio",className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[(0,s.jsx)(u.Z,{className:"w-4 h-4 mr-1"}),(0,s.jsx)("span",{className:"text-sm",children:"Kembali ke Kelola Portofolio"})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-md p-4 lg:p-6",children:(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 lg:w-12 lg:h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full flex items-center justify-center",children:(0,s.jsx)(x.Z,{className:"w-5 h-5 lg:w-6 lg:h-6 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900",children:"Edit Portofolio"}),(0,s.jsx)("p",{className:"text-sm lg:text-base text-gray-600",children:_.post_title}),z&&(0,s.jsxs)("span",{className:"inline-flex items-center text-xs text-orange-600 mt-1",children:[(0,s.jsx)(h.Z,{className:"w-3 h-3 mr-1"}),"Ada perubahan yang belum disimpan"]})]})]}),(0,s.jsx)("div",{className:"flex space-x-2",children:(0,s.jsxs)("button",{onClick:ee,disabled:$||!ea,className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[$?(0,s.jsx)(m.Z,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(p.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:$?"Menyimpan...":"Simpan"})]})})]})})]}),M&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg flex items-center",children:[(0,s.jsx)(h.Z,{className:"w-5 h-5 mr-2"}),M]}),T&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg flex items-center",children:[(0,s.jsx)(f.Z,{className:"w-5 h-5 mr-2"}),T]}),(-1===D||!F[D])&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg flex items-center",children:[(0,s.jsx)(b.Z,{className:"w-5 h-5 mr-2"}),"Thumbnail harus dipilih dari salah satu gambar sebelum portofolio dapat disimpan"]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 lg:p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informasi Dasar"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"lg:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Judul Portofolio *"}),(0,s.jsx)("input",{type:"text",value:U.post_title,onChange:e=>B("post_title",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Judul portofolio",required:!0}),U.post_title&&(0,s.jsxs)("div",{className:"mt-1 p-2 bg-blue-50 border border-blue-200 rounded text-sm",children:[(0,s.jsx)(j.Z,{className:"w-4 h-4 inline mr-1 text-blue-600"}),(0,s.jsxs)("span",{className:"text-blue-700",children:["Slug: ",(0,s.jsx)("strong",{children:U.post_title.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"")})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kategori *"}),(0,s.jsx)("input",{type:"text",value:U.category,onChange:e=>B("category",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Kategori portofolio",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lokasi"}),(0,s.jsx)("input",{type:"text",value:U.location,onChange:e=>B("location",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Lokasi proyek"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tanggal Unggahan"}),(0,s.jsx)("input",{type:"text",value:U.tanggal_unggahan,onChange:e=>B("tanggal_unggahan",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Contoh: 25 Juli 2025"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Style View"}),(0,s.jsxs)("select",{value:U.style_view,onChange:e=>B("style_view",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,s.jsx)("option",{value:"1-Grid",children:"1-Grid"}),(0,s.jsx)("option",{value:"3-Grid",children:"3-Grid"})]})]})]})]}),(0,s.jsx)(o.Z,{title:"Gambar Portofolio",subtitle:"Upload gambar portofolio (maksimal 20MB per gambar, format: JPG, PNG, WebP)",icon:(0,s.jsx)(g.Z,{className:"w-5 h-5 text-green-600"}),defaultOpen:!0,className:"transition-all duration-300 hover:shadow-lg",headerClassName:"hover:bg-green-50",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:`border rounded-lg p-3 ${-1!==D&&F[D]?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:-1!==D&&F[D]?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.Z,{className:"w-4 h-4 inline mr-2 text-green-600"}),(0,s.jsxs)("span",{className:"text-sm text-green-700",children:[(0,s.jsx)("strong",{children:"Thumbnail dipilih:"})," Gambar ",D+1]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.Z,{className:"w-4 h-4 inline mr-2 text-red-600"}),(0,s.jsxs)("span",{className:"text-sm text-red-700",children:[(0,s.jsx)("strong",{children:"Pilih thumbnail!"}),' Klik tombol "Set Thumbnail" pada salah satu gambar.']})]})}),(0,s.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-6 gap-4",children:Array.from({length:30},(e,a)=>{let t=F[a],l=a===D;return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:`aspect-square border-2 border-dashed rounded-lg flex items-center justify-center bg-gray-50 overflow-hidden transition-all duration-200 ${l?"border-green-300 bg-green-50 ring-2 ring-green-200":"border-gray-300 hover:border-gray-400"}`,children:t?(0,s.jsxs)("div",{className:"relative w-full h-full group",children:[(0,s.jsx)("img",{src:t.startsWith("data:")?t:`https://api.seniindah.co.id/${t}`,alt:`Gambar ${a+1}`,className:"w-full h-full object-cover"}),l&&(0,s.jsxs)("div",{className:"absolute top-1 left-1 bg-green-600 text-white text-xs px-2 py-1 rounded shadow-sm flex items-center",children:[(0,s.jsx)(y.Z,{className:"w-3 h-3 mr-1"}),"Thumbnail"]}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 flex items-center justify-center transition-all duration-200",children:(0,s.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 flex space-x-1",children:[!l&&(0,s.jsx)("button",{onClick:()=>Y(a),className:"p-1 bg-green-600 text-white rounded text-xs hover:bg-green-700 transition-colors",title:"Set sebagai thumbnail",children:(0,s.jsx)(y.Z,{className:"w-3 h-3"})}),(0,s.jsx)("button",{onClick:()=>X(a,"image"),className:"p-1 bg-red-600 text-white rounded text-xs hover:bg-red-700 transition-colors",title:`Hapus gambar ${a+1}`,children:(0,s.jsx)(v.Z,{className:"w-3 h-3"})})]})})]}):(0,s.jsx)("div",{className:"text-center",children:(0,s.jsxs)("label",{className:"cursor-pointer flex flex-col items-center hover:text-gray-600 transition-colors",children:[(0,s.jsx)(g.Z,{className:"w-4 h-4 text-gray-400 mb-1"}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"Upload"}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{let t=e.target.files?.[0];t&&I(a,t)},className:"hidden"})]})})}),(0,s.jsx)("div",{className:"text-center mt-1",children:(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Gambar ",a+1]})})]},a)})})]})}),(0,s.jsx)(o.Z,{title:"Video Portofolio",subtitle:"Upload video portofolio (maksimal 100MB per video, format: MP4, WebM, MOV)",icon:(0,s.jsx)(N.Z,{className:"w-5 h-5 text-blue-600"}),defaultOpen:!1,className:"transition-all duration-300 hover:shadow-lg",headerClassName:"hover:bg-blue-50",children:(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4",children:Array.from({length:15},(e,a)=>{let t=L[a];return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"aspect-video border-2 border-dashed rounded-lg flex items-center justify-center bg-gray-50 overflow-hidden transition-all duration-200 border-gray-300 hover:border-gray-400",children:t?(0,s.jsxs)("div",{className:"relative w-full h-full group",children:[(0,s.jsx)("video",{className:"w-full h-full object-cover",controls:!0,preload:"metadata",children:(0,s.jsx)("source",{src:t.startsWith("blob:")?t:`https://api.seniindah.co.id/${t}`})}),(0,s.jsx)("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)("button",{onClick:()=>X(a,"video"),className:"p-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",title:`Hapus video ${a+1}`,children:(0,s.jsx)(v.Z,{className:"w-3 h-3"})})})]}):(0,s.jsx)("div",{className:"text-center",children:(0,s.jsxs)("label",{className:"cursor-pointer flex flex-col items-center hover:text-gray-600 transition-colors",children:[(0,s.jsx)(N.Z,{className:"w-4 h-4 text-gray-400 mb-1"}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"Upload"}),(0,s.jsx)("input",{type:"file",accept:"video/*",onChange:e=>{let t=e.target.files?.[0];t&&Q(a,t)},className:"hidden"})]})})}),(0,s.jsx)("div",{className:"text-center mt-1",children:(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Video ",a+1]})})]},a)})})})}),(0,s.jsx)(o.Z,{title:"Deskripsi Portofolio",subtitle:"Tulis deskripsi lengkap portofolio dengan format yang menarik",icon:(0,s.jsx)(w.Z,{className:"w-5 h-5 text-orange-600"}),defaultOpen:!1,className:"transition-all duration-300 hover:shadow-lg",headerClassName:"hover:bg-orange-50",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:(0,s.jsx)(n.Z,{id:"description-editor",value:U.deskripsi,onChange:e=>B("deskripsi",e),height:400,placeholder:"Tulis deskripsi lengkap portofolio... Gunakan toolbar untuk formatting text."})}),U.deskripsi&&(0,s.jsx)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:(0,s.jsxs)("span",{children:[U.deskripsi.replace(/<[^>]*>/g,"").length," karakter"]})}),!U.deskripsi&&(0,s.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,s.jsx)(w.Z,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,s.jsx)("p",{className:"text-sm",children:"Belum ada deskripsi portofolio"})]})]})})]})]})})})}}},function(e){e.O(0,[7138,8931,8369,4682,1014,2971,3526,1744],function(){return e(e.s=3787)}),_N_E=e.O()}]);